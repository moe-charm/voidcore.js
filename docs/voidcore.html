<!-- voidcore.html -->
<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>VoidCore.js Demo</title></head>
<body>
  <h1>ğŸ§© VoidCore.js Plugin Demo</h1>
  <div id="log"></div>

  <script>
    // ğŸŒ CoreBulletinBoard
    class CoreBulletinBoard {
      constructor() {
        this.board = new Map();
      }

      provide(cap, val) {
        this.board.set(cap, val);
        log(`ğŸ“Œ provide: ${cap}`);
      }

      retract(cap) {
        this.board.delete(cap);
        log(`âŒ retract: ${cap}`);
      }

      observe(cap) {
        return this.board.get(cap);
      }
    }

    // ğŸ“ ãƒ­ã‚°å‡ºåŠ›
    function log(msg) {
      document.getElementById("log").innerHTML += msg + "<br>";
    }

    // ğŸŒŸ AutonomousPlugin
    class DemoPlugin {
      constructor(board) {
        this.board = board;
        this.prepare();
        this.provide_self();
        setTimeout(() => this.run(), 500);  // simulate delay
      }

      prepare() {
        log("ğŸ› ï¸ Plugin prepared");
      }

      provide_self() {
        this.board.provide("DemoService", this);
      }

      run() {
        let logger = this.board.observe("LoggerService");
        if (logger) {
          logger.log("ğŸ“£ Hello from DemoPlugin");
        } else {
          log("âš ï¸ LoggerService not found");
        }
      }

      destroy() {
        this.board.retract("DemoService");
        log("ğŸ‘‹ Plugin destroyed");
      }
    }

    class LoggerPlugin {
      constructor(board) {
        this.board = board;
        this.board.provide("LoggerService", this);
      }

      log(msg) {
        log("ğŸ§¾ " + msg);
      }
    }

    // â–¶ï¸ å®Ÿè¡Œ
    const board = new CoreBulletinBoard();
    new LoggerPlugin(board);
    const plugin = new DemoPlugin(board);
    
    // 3ç§’å¾Œã«å‰Šé™¤
    setTimeout(() => plugin.destroy(), 3000);
  </script>
</body>
</html>
