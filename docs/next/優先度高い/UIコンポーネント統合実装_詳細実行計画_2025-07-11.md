# ğŸ¯ UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆå®Ÿè£… - è©³ç´°å®Ÿè¡Œè¨ˆç”»

**ä½œæˆæ—¥**: 2025-07-11  
**å®Ÿè¡Œé–‹å§‹**: å³åº§  
**å®Œäº†ç›®æ¨™**: 6.5é€±é–“  
**å„ªå…ˆåº¦**: ğŸ”´ æœ€é«˜  

**ğŸ“‹ åŸºç›¤æˆ¦ç•¥**: Geminiçµ±åˆæˆ¦ç•¥æ¡ç”¨  
**ğŸ¯ æœ€çµ‚ç›®æ¨™**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ = UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ– + ã‚²ãƒ¼ãƒ é–‹ç™ºåŸºç›¤å®Œæˆ

---

## ğŸ—ï¸ **Phase 1: åŸºç›¤ + ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿çµ±åˆ** (1-1.5é€±é–“)

### **ğŸ¯ Phase 1 ç›®æ¨™**
- BaseUIComponentåŸºåº•ã‚¯ãƒ©ã‚¹ç¢ºç«‹
- PropertyInspectorComponentå®Ÿç”¨åŒ–
- Intenté€šä¿¡åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºç«‹
- ä»–UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Œæˆ

---

### **ğŸ“… Day 1: BaseUIComponentå®Ÿè£…**

#### **ğŸ”§ Task 1.1: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèªãƒ»ä½œæˆ** (30åˆ†)
```bash
# å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
ls -la /mnt/workdisk/public_share/voidcore-js/charmflow/js/ui-components/
# å­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
mkdir -p /mnt/workdisk/public_share/voidcore-js/charmflow/js/ui-components/
```

#### **ğŸ”§ Task 1.2: BaseUIComponent.js å®Ÿè£…** (3-4æ™‚é–“)
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `/charmflow/js/ui-components/BaseUIComponent.js`

**å®Ÿè£…å†…å®¹**:
```javascript
/**
 * ğŸ—ï¸ BaseUIComponent - å…¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±ä¸€åŸºåº•ã‚¯ãƒ©ã‚¹
 * Geminiçµ±åˆæˆ¦ç•¥: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«å®Ÿè£…
 */
export class BaseUIComponent {
    constructor(pluginNode, options = {}) {
        // åŸºæœ¬è¨­å®š
        this.pluginNode = pluginNode
        this.id = pluginNode.id + '-ui-component'
        this.type = options.type || 'base'
        
        // Intenté€šä¿¡
        this.intentHandler = pluginNode.intentHandler || window.charmFlowCore
        
        // DOMè¦ç´ 
        this.element = null
        this.containerElement = null
        
        // çŠ¶æ…‹ç®¡ç†
        this.state = {
            isVisible: false,
            isExpanded: false,
            ...options.initialState
        }
        
        // è¨­å®š
        this.options = {
            position: { x: 100, y: 100 },
            size: { width: 300, height: 200 },
            resizable: true,
            draggable: true,
            zIndex: 1000,
            ...options
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç®¡ç†
        this.eventListeners = []
        
        // åˆæœŸåŒ–
        this.initialize()
    }
    
    /**
     * åˆæœŸåŒ–å‡¦ç†
     */
    initialize() {
        this.setupIntentListeners()
        this.log('BaseUIComponent initialized', { id: this.id, type: this.type })
    }
    
    /**
     * Intent ãƒªã‚¹ãƒŠãƒ¼è¨­å®š (ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰)
     */
    setupIntentListeners() {
        // åŸºæœ¬çš„ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ¶å¾¡Intent
        this.addIntentListener('charmflow.ui.component.expand', (data) => {
            if (data.componentId === this.id) this.expand()
        })
        
        this.addIntentListener('charmflow.ui.component.collapse', (data) => {
            if (data.componentId === this.id) this.collapse()
        })
        
        this.addIntentListener('charmflow.ui.component.state.sync', (data) => {
            if (data.componentId === this.id) this.updateState(data.newState)
        })
    }
    
    /**
     * DOMè¦ç´ ä½œæˆãƒ»æç”» (ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§å¿…é ˆå®Ÿè£…)
     */
    render() {
        throw new Error('render() method must be implemented by subclasses')
    }
    
    /**
     * DOMè¦ç´ ã‚’ãƒšãƒ¼ã‚¸ã«è¿½åŠ 
     */
    mount(parentElement = document.body) {
        if (!this.element) {
            this.element = this.render()
        }
        
        if (this.element && !this.element.parentElement) {
            parentElement.appendChild(this.element)
            this.onMounted()
        }
        
        return this.element
    }
    
    /**
     * DOMè¦ç´ ã‚’ãƒšãƒ¼ã‚¸ã‹ã‚‰å‰Šé™¤
     */
    unmount() {
        if (this.element && this.element.parentElement) {
            this.element.parentElement.removeChild(this.element)
            this.onUnmounted()
        }
    }
    
    /**
     * è¡¨ç¤º
     */
    show() {
        if (this.element) {
            this.element.style.display = 'block'
            this.state.isVisible = true
            this.onShown()
        }
    }
    
    /**
     * éè¡¨ç¤º
     */
    hide() {
        if (this.element) {
            this.element.style.display = 'none'
            this.state.isVisible = false
            this.onHidden()
        }
    }
    
    /**
     * å±•é–‹
     */
    expand() {
        this.state.isExpanded = true
        this.show()
        this.onExpanded()
    }
    
    /**
     * ç¸®å°
     */
    collapse() {
        this.state.isExpanded = false
        this.hide()
        this.onCollapsed()
    }
    
    /**
     * çŠ¶æ…‹æ›´æ–°
     */
    updateState(newState) {
        const oldState = { ...this.state }
        this.state = { ...this.state, ...newState }
        this.onStateChanged(this.state, oldState)
    }
    
    /**
     * Intenté€ä¿¡ãƒ˜ãƒ«ãƒ‘ãƒ¼
     */
    sendIntent(type, payload = {}) {
        const intentData = {
            ...payload,
            componentId: this.id,
            pluginNodeId: this.pluginNode.id,
            timestamp: Date.now(),
            source: 'ui-component'
        }
        
        if (this.intentHandler && typeof this.intentHandler.sendIntent === 'function') {
            this.intentHandler.sendIntent(type, intentData)
        } else {
            this.log('Warning: intentHandler not available', { type, payload: intentData })
        }
    }
    
    /**
     * Intent ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
     */
    addIntentListener(intentType, handler) {
        if (this.intentHandler && typeof this.intentHandler.addIntentListener === 'function') {
            const listenerId = this.intentHandler.addIntentListener(intentType, handler)
            this.eventListeners.push({ type: 'intent', intentType, handler, listenerId })
            return listenerId
        }
    }
    
    /**
     * DOM ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
     */
    addEventListener(element, eventType, handler) {
        element.addEventListener(eventType, handler)
        this.eventListeners.push({ type: 'dom', element, eventType, handler })
    }
    
    /**
     * ãƒ­ã‚°å‡ºåŠ›
     */
    log(message, data = {}) {
        if (window.debugLogger) {
            window.debugLogger.log('ui', 'info', `[${this.type}] ${message}`, {
                componentId: this.id,
                pluginNodeId: this.pluginNode.id,
                ...data
            })
        } else {
            console.log(`[UIComponent:${this.type}] ${message}`, data)
        }
    }
    
    /**
     * ç ´æ£„å‡¦ç†
     */
    destroy() {
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼å‰Šé™¤
        this.eventListeners.forEach(listener => {
            if (listener.type === 'dom') {
                listener.element.removeEventListener(listener.eventType, listener.handler)
            } else if (listener.type === 'intent' && listener.listenerId) {
                // Intent ãƒªã‚¹ãƒŠãƒ¼å‰Šé™¤ (å®Ÿè£…ä¾å­˜)
                if (this.intentHandler && typeof this.intentHandler.removeIntentListener === 'function') {
                    this.intentHandler.removeIntentListener(listener.listenerId)
                }
            }
        })
        
        // DOMè¦ç´ å‰Šé™¤
        this.unmount()
        
        // å‚ç…§ã‚¯ãƒªã‚¢
        this.element = null
        this.pluginNode = null
        this.intentHandler = null
        this.eventListeners = []
        
        this.onDestroyed()
    }
    
    // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ (ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰å¯èƒ½)
    onMounted() { this.log('Component mounted') }
    onUnmounted() { this.log('Component unmounted') }
    onShown() { this.log('Component shown') }
    onHidden() { this.log('Component hidden') }
    onExpanded() { this.log('Component expanded') }
    onCollapsed() { this.log('Component collapsed') }
    onStateChanged(newState, oldState) { this.log('State changed', { newState, oldState }) }
    onDestroyed() { this.log('Component destroyed') }
}

// ã‚°ãƒ­ãƒ¼ãƒãƒ«å…¬é–‹
window.BaseUIComponent = BaseUIComponent
```

#### **ğŸ”§ Task 1.3: å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ** (1æ™‚é–“)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `/charmflow/test-base-ui-component.html`

```html
<!DOCTYPE html>
<html>
<head>
    <title>BaseUIComponent Test</title>
</head>
<body>
    <h1>BaseUIComponent å‹•ä½œç¢ºèª</h1>
    <button id="test-btn">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
    <div id="test-results"></div>
    
    <script type="module">
        import { BaseUIComponent } from './js/ui-components/BaseUIComponent.js'
        
        // ãƒ¢ãƒƒã‚¯PluginNode
        const mockPluginNode = {
            id: 'test-plugin-node',
            intentHandler: {
                sendIntent: (type, data) => console.log('Intent sent:', type, data),
                addIntentListener: (type, handler) => console.log('Intent listener added:', type)
            }
        }
        
        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        document.getElementById('test-btn').onclick = () => {
            const component = new BaseUIComponent(mockPluginNode, {
                type: 'test-component',
                initialState: { testValue: 'hello' }
            })
            
            console.log('BaseUIComponent created:', component)
            document.getElementById('test-results').innerHTML = 
                `<pre>${JSON.stringify(component.state, null, 2)}</pre>`
        }
    </script>
</body>
</html>
```

**æˆåŠŸæŒ‡æ¨™**:
- [ ] BaseUIComponent ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ
- [ ] ãƒ­ã‚°å‡ºåŠ›ç¢ºèª
- [ ] çŠ¶æ…‹ç®¡ç†å‹•ä½œç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ãªã—ã§å‹•ä½œ

---

### **ğŸ“… Day 2-3: PropertyInspectorComponentå®Ÿè£…**

#### **ğŸ”§ Task 2.1: Intentå®šç¾©è¿½åŠ ** (1æ™‚é–“)
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `/charmflow/js/intent-definitions.js`

**è¿½åŠ å†…å®¹**:
```javascript
// INTENT_TYPES.UI ã«è¿½åŠ 
PROPERTY_INSPECTOR: {
  NODE_SELECTED: 'charmflow.ui.property.node.selected',
  NODE_DESELECTED: 'charmflow.ui.property.node.deselected',
  UPDATE_NODE_PROPERTY: 'charmflow.ui.property.node.update',
  SHOW_INSPECTOR: 'charmflow.ui.property.inspector.show',
  HIDE_INSPECTOR: 'charmflow.ui.property.inspector.hide'
},

COMPONENT: {
  EXPAND: 'charmflow.ui.component.expand',
  COLLAPSE: 'charmflow.ui.component.collapse',
  STATE_SYNC: 'charmflow.ui.component.state.sync'
}
```

#### **ğŸ”§ Task 2.2: PropertyInspectorComponentå®Ÿè£…** (4-5æ™‚é–“)
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `/charmflow/js/ui-components/PropertyInspectorComponent.js`

**å®Ÿè£…å†…å®¹**:
```javascript
import { BaseUIComponent } from './BaseUIComponent.js'
import { INTENT_TYPES } from '../intent-definitions.js'

/**
 * ğŸ” PropertyInspectorComponent
 * Geminiæˆ¦ç•¥: åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£… (å—ä¿¡â†’è¡¨ç¤ºâ†’é€ä¿¡)
 */
export class PropertyInspectorComponent extends BaseUIComponent {
    constructor(pluginNode, options = {}) {
        super(pluginNode, {
            type: 'property-inspector',
            position: { x: 20, y: 100 },
            size: { width: 280, height: 400 },
            ...options
        })
        
        this.currentNodeData = null
        this.propertyFields = new Map()
    }
    
    setupIntentListeners() {
        super.setupIntentListeners()
        
        // Geminiæˆ¦ç•¥: å—ä¿¡ - ãƒãƒ¼ãƒ‰é¸æŠã‚’ãƒªãƒƒã‚¹ãƒ³
        this.addIntentListener(INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_SELECTED, (data) => {
            this.showNodeProperties(data)
        })
        
        this.addIntentListener(INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_DESELECTED, () => {
            this.clearProperties()
        })
        
        this.addIntentListener(INTENT_TYPES.UI.PROPERTY_INSPECTOR.SHOW_INSPECTOR, () => {
            this.show()
        })
        
        this.addIntentListener(INTENT_TYPES.UI.PROPERTY_INSPECTOR.HIDE_INSPECTOR, () => {
            this.hide()
        })
    }
    
    render() {
        const element = document.createElement('div')
        element.className = 'property-inspector-component'
        element.style.cssText = `
            position: fixed;
            left: ${this.options.position.x}px;
            top: ${this.options.position.y}px;
            width: ${this.options.size.width}px;
            height: ${this.options.size.height}px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-family: Arial, sans-serif;
            font-size: 12px;
            z-index: ${this.options.zIndex};
            display: none;
        `
        
        element.innerHTML = `
            <div class="property-inspector-header" style="
                background: #f5f5f5;
                padding: 8px 12px;
                border-bottom: 1px solid #ddd;
                border-radius: 7px 7px 0 0;
                font-weight: bold;
                display: flex;
                justify-content: space-between;
                align-items: center;
            ">
                <span>ğŸ” ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</span>
                <button class="close-btn" style="
                    background: none;
                    border: none;
                    font-size: 16px;
                    cursor: pointer;
                    padding: 0;
                    width: 20px;
                    height: 20px;
                ">Ã—</button>
            </div>
            
            <div class="property-inspector-content" style="
                padding: 12px;
                height: calc(100% - 45px);
                overflow-y: auto;
            ">
                <div class="no-selection" style="
                    text-align: center;
                    color: #999;
                    margin-top: 50px;
                ">
                    ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
            </div>
        `
        
        this.setupEventHandlers(element)
        return element
    }
    
    setupEventHandlers(element) {
        // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
        const closeBtn = element.querySelector('.close-btn')
        this.addEventListener(closeBtn, 'click', () => {
            this.hide()
        })
        
        // ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½
        const header = element.querySelector('.property-inspector-header')
        this.setupDragging(header, element)
    }
    
    setupDragging(dragHandle, element) {
        let isDragging = false
        let dragOffset = { x: 0, y: 0 }
        
        this.addEventListener(dragHandle, 'mousedown', (e) => {
            isDragging = true
            const rect = element.getBoundingClientRect()
            dragOffset.x = e.clientX - rect.left
            dragOffset.y = e.clientY - rect.top
            element.style.cursor = 'grabbing'
        })
        
        this.addEventListener(document, 'mousemove', (e) => {
            if (!isDragging) return
            
            const newX = e.clientX - dragOffset.x
            const newY = e.clientY - dragOffset.y
            
            element.style.left = newX + 'px'
            element.style.top = newY + 'px'
            
            this.options.position = { x: newX, y: newY }
        })
        
        this.addEventListener(document, 'mouseup', () => {
            isDragging = false
            element.style.cursor = 'default'
        })
    }
    
    showNodeProperties(nodeData) {
        // Geminiæˆ¦ç•¥: è¡¨ç¤º - ãƒãƒ¼ãƒ‰ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’UIè¡¨ç¤º
        this.currentNodeData = nodeData
        const content = this.element.querySelector('.property-inspector-content')
        
        content.innerHTML = `
            <div class="property-group">
                <h3 style="margin: 0 0 8px 0; font-size: 13px; color: #333;">åŸºæœ¬æƒ…å ±</h3>
                <div class="property-item" style="margin-bottom: 8px;">
                    <label style="display: block; margin-bottom: 2px; font-weight: bold;">ID:</label>
                    <input type="text" value="${nodeData.nodeId || 'N/A'}" readonly 
                           style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; background: #f9f9f9;">
                </div>
                <div class="property-item" style="margin-bottom: 8px;">
                    <label style="display: block; margin-bottom: 2px; font-weight: bold;">ã‚¿ã‚¤ãƒ—:</label>
                    <input type="text" value="${nodeData.nodeType || 'N/A'}" readonly
                           style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; background: #f9f9f9;">
                </div>
            </div>
            
            <div class="property-group" style="margin-top: 16px;">
                <h3 style="margin: 0 0 8px 0; font-size: 13px; color: #333;">è¨­å®š</h3>
                <div class="dynamic-properties">
                    ${this.renderDynamicProperties(nodeData.properties || {})}
                </div>
            </div>
            
            <div class="property-actions" style="margin-top: 16px; text-align: center;">
                <button class="save-properties-btn" style="
                    background: #007acc;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-right: 8px;
                ">ğŸ’¾ ä¿å­˜</button>
                <button class="reset-properties-btn" style="
                    background: #999;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                ">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        `
        
        this.setupPropertyHandlers()
        this.show()
    }
    
    renderDynamicProperties(properties) {
        return Object.entries(properties).map(([key, value]) => `
            <div class="property-item" style="margin-bottom: 8px;">
                <label style="display: block; margin-bottom: 2px; font-weight: bold;">${key}:</label>
                <input type="text" 
                       class="property-input"
                       data-property="${key}" 
                       value="${this.escapeHtml(String(value))}"
                       style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px;">
            </div>
        `).join('')
    }
    
    setupPropertyHandlers() {
        // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        const propertyInputs = this.element.querySelectorAll('.property-input')
        propertyInputs.forEach(input => {
            this.addEventListener(input, 'change', (e) => {
                this.handlePropertyChange(e.target.dataset.property, e.target.value)
            })
        })
        
        // ä¿å­˜ãƒœã‚¿ãƒ³
        const saveBtn = this.element.querySelector('.save-properties-btn')
        this.addEventListener(saveBtn, 'click', () => {
            this.saveAllProperties()
        })
        
        // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
        const resetBtn = this.element.querySelector('.reset-properties-btn')
        this.addEventListener(resetBtn, 'click', () => {
            this.resetProperties()
        })
    }
    
    handlePropertyChange(propertyName, newValue) {
        // Geminiæˆ¦ç•¥: é€ä¿¡ - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã‚’Intentç™ºè¡Œ
        if (!this.currentNodeData) return
        
        this.sendIntent(INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY, {
            nodeId: this.currentNodeData.nodeId,
            propertyName,
            newValue,
            oldValue: this.currentNodeData.properties?.[propertyName]
        })
        
        this.log('Property changed', { propertyName, newValue })
    }
    
    saveAllProperties() {
        if (!this.currentNodeData) return
        
        const inputs = this.element.querySelectorAll('.property-input')
        const updates = []
        
        inputs.forEach(input => {
            const propertyName = input.dataset.property
            const newValue = input.value
            const oldValue = this.currentNodeData.properties?.[propertyName]
            
            if (newValue !== String(oldValue)) {
                updates.push({ propertyName, newValue, oldValue })
                
                this.sendIntent(INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY, {
                    nodeId: this.currentNodeData.nodeId,
                    propertyName,
                    newValue,
                    oldValue
                })
            }
        })
        
        this.log('All properties saved', { updates, count: updates.length })
    }
    
    resetProperties() {
        if (!this.currentNodeData) return
        
        const inputs = this.element.querySelectorAll('.property-input')
        inputs.forEach(input => {
            const propertyName = input.dataset.property
            const originalValue = this.currentNodeData.properties?.[propertyName] || ''
            input.value = originalValue
        })
        
        this.log('Properties reset')
    }
    
    clearProperties() {
        const content = this.element.querySelector('.property-inspector-content')
        content.innerHTML = `
            <div class="no-selection" style="
                text-align: center;
                color: #999;
                margin-top: 50px;
            ">
                ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
        `
        this.currentNodeData = null
        this.log('Properties cleared')
    }
    
    escapeHtml(text) {
        const div = document.createElement('div')
        div.textContent = text
        return div.innerHTML
    }
}

// ã‚°ãƒ­ãƒ¼ãƒãƒ«å…¬é–‹
window.PropertyInspectorComponent = PropertyInspectorComponent
```

#### **ğŸ”§ Task 2.3: PropertyInspectorçµ±åˆãƒ†ã‚¹ãƒˆ** (2æ™‚é–“)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `/charmflow/test-property-inspector.html`

```html
<!DOCTYPE html>
<html>
<head>
    <title>PropertyInspector Test</title>
</head>
<body>
    <h1>PropertyInspector å‹•ä½œç¢ºèª</h1>
    <button id="show-inspector">ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿è¡¨ç¤º</button>
    <button id="select-node">ãƒãƒ¼ãƒ‰é¸æŠã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
    <button id="deselect-node">é¸æŠè§£é™¤</button>
    
    <script type="module">
        import { PropertyInspectorComponent } from './js/ui-components/PropertyInspectorComponent.js'
        import { INTENT_TYPES } from './js/intent-definitions.js'
        
        // ãƒ¢ãƒƒã‚¯ç’°å¢ƒ
        const mockIntentHandler = {
            listeners: new Map(),
            sendIntent: (type, data) => {
                console.log('ğŸ“¤ Intent sent:', type, data)
            },
            addIntentListener: (type, handler) => {
                if (!this.listeners.has(type)) {
                    this.listeners.set(type, [])
                }
                this.listeners.get(type).push(handler)
                return `listener-${Date.now()}`
            },
            triggerIntent: (type, data) => {
                const handlers = this.listeners.get(type) || []
                handlers.forEach(handler => handler(data))
            }
        }
        
        const mockPluginNode = {
            id: 'test-plugin-node',
            intentHandler: mockIntentHandler
        }
        
        // PropertyInspectorä½œæˆ
        const inspector = new PropertyInspectorComponent(mockPluginNode)
        inspector.mount()
        
        // ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³è¨­å®š
        document.getElementById('show-inspector').onclick = () => {
            inspector.show()
        }
        
        document.getElementById('select-node').onclick = () => {
            const testNodeData = {
                nodeId: 'test-node-123',
                nodeType: 'button.send',
                properties: {
                    label: 'ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³',
                    color: '#ff0000',
                    enabled: true,
                    timeout: 5000
                }
            }
            
            mockIntentHandler.triggerIntent(
                INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_SELECTED,
                testNodeData
            )
        }
        
        document.getElementById('deselect-node').onclick = () => {
            mockIntentHandler.triggerIntent(
                INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_DESELECTED,
                {}
            )
        }
    </script>
</body>
</html>
```

**æˆåŠŸæŒ‡æ¨™**:
- [ ] ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿è¡¨ç¤º
- [ ] ãƒãƒ¼ãƒ‰é¸æŠã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¡¨ç¤º
- [ ] ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã§Intenté€ä¿¡
- [ ] ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•å‹•ä½œ
- [ ] ä¿å­˜ãƒ»ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½å‹•ä½œ

---

### **ğŸ“… Day 4-5: PluginNodeçµ±åˆ**

#### **ğŸ”§ Task 3.1: æ—¢å­˜PluginNodeåˆ†æ** (1æ™‚é–“)
**èª¿æŸ»ãƒ•ã‚¡ã‚¤ãƒ«**: 
- `/charmflow/js/charmflow-node-plugin.js`
- `/charmflow/js/ui-nodes/` å†…ãƒ•ã‚¡ã‚¤ãƒ«

**èª¿æŸ»å†…å®¹**:
- ç¾åœ¨ã®PluginNodeæ§‹é€ 
- æ—¢å­˜UIã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆç‚¹
- å¤‰æ›´ãŒå¿…è¦ãªç®‡æ‰€ã®ç‰¹å®š

#### **ğŸ”§ Task 3.2: PluginNodeæ‹¡å¼µå®Ÿè£…** (3-4æ™‚é–“)
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `/charmflow/js/charmflow-node-plugin.js` (é©åˆ‡ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®šå¾Œ)

**è¿½åŠ å®Ÿè£…å†…å®¹**:
```javascript
// PluginNode ã‚¯ãƒ©ã‚¹ã«è¿½åŠ 
class PluginNode {
    constructor(options) {
        // æ—¢å­˜å®Ÿè£…...
        
        // UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–¢é€£è¿½åŠ 
        this.uiComponent = null
        this.isExpanded = false
        this.uiComponentType = options.uiComponentType || null
        
        // UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­å®š
        this.uiOptions = options.uiOptions || {}
    }
    
    /**
     * UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå±•é–‹/ç¸®å°åˆ‡ã‚Šæ›¿ãˆ
     */
    async toggleExpand() {
        this.isExpanded = !this.isExpanded
        
        if (this.isExpanded && !this.uiComponent && this.uiComponentType) {
            try {
                // å‹•çš„ã«UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿
                const { [this.uiComponentType]: ComponentClass } = await import(`./ui-components/${this.uiComponentType}.js`)
                
                this.uiComponent = new ComponentClass(this, this.uiOptions)
                this.uiComponent.mount()
                this.uiComponent.show()
                
                this.log('UI component expanded', { type: this.uiComponentType })
                
            } catch (error) {
                console.error(`Failed to load UI component: ${this.uiComponentType}`, error)
                this.isExpanded = false
                this.log('UI component load failed', { error: error.message })
            }
        } else if (this.uiComponent) {
            if (this.isExpanded) {
                this.uiComponent.show()
            } else {
                this.uiComponent.hide()
            }
        }
        
        // ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«æ›´æ–°
        this.updateVisual()
    }
    
    /**
     * UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒåˆ©ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
     */
    hasUIComponent() {
        return !!this.uiComponentType
    }
    
    /**
     * ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«æ›´æ–° (å±•é–‹çŠ¶æ…‹ã«å¿œã˜ã¦è¡¨ç¤ºå¤‰æ›´)
     */
    updateVisual() {
        if (this.element) {
            const indicator = this.element.querySelector('.ui-expand-indicator')
            if (!indicator && this.hasUIComponent()) {
                // å±•é–‹å¯èƒ½ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼è¿½åŠ 
                const expandBtn = document.createElement('div')
                expandBtn.className = 'ui-expand-indicator'
                expandBtn.innerHTML = this.isExpanded ? 'ğŸ”½' : 'â–¶ï¸'
                expandBtn.style.cssText = `
                    position: absolute;
                    top: 2px;
                    right: 2px;
                    font-size: 12px;
                    cursor: pointer;
                    background: rgba(255,255,255,0.8);
                    border-radius: 3px;
                    padding: 2px;
                `
                
                expandBtn.onclick = (e) => {
                    e.stopPropagation()
                    this.toggleExpand()
                }
                
                this.element.appendChild(expandBtn)
            } else if (indicator) {
                indicator.innerHTML = this.isExpanded ? 'ğŸ”½' : 'â–¶ï¸'
            }
        }
    }
    
    /**
     * ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒ¼ãƒ‰ç ´æ£„æ™‚ã®å‡¦ç†
     */
    destroy() {
        if (this.uiComponent) {
            this.uiComponent.destroy()
            this.uiComponent = null
        }
        
        // æ—¢å­˜ç ´æ£„å‡¦ç†...
    }
}
```

#### **ğŸ”§ Task 3.3: çµ±åˆå‹•ä½œç¢ºèª** (2æ™‚é–“)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `/charmflow/test-plugin-node-integration.html`

**ãƒ†ã‚¹ãƒˆå†…å®¹**:
- PluginNodeãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§PropertyInspectorå±•é–‹
- ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã§PluginNodeçŠ¶æ…‹æ›´æ–°
- Intenté€šä¿¡ã®æ­£å¸¸å‹•ä½œç¢ºèª

**æˆåŠŸæŒ‡æ¨™**:
- [ ] PluginNodeã«å±•é–‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼è¡¨ç¤º
- [ ] ã‚¯ãƒªãƒƒã‚¯ã§UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå±•é–‹/ç¸®å°
- [ ] PropertyInspectorã¨ã®é€£æºå‹•ä½œ
- [ ] Intenté€šä¿¡æ­£å¸¸å‹•ä½œ

---

## ğŸ—ï¸ **Phase 2: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‹¡å¼µ** (1.5-2é€±é–“)

### **ğŸ“… Week 2: SimpleButtonComponent + ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢**

#### **ğŸ”§ Task 4.1: SimpleButtonComponentå®Ÿè£…** (2æ—¥)
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `/charmflow/js/ui-components/SimpleButtonComponent.js`

**å®Ÿè£…å†…å®¹**:
```javascript
import { BaseUIComponent } from './BaseUIComponent.js'

export class SimpleButtonComponent extends BaseUIComponent {
    constructor(pluginNode, options = {}) {
        super(pluginNode, {
            type: 'simple-button',
            size: { width: 200, height: 100 },
            ...options
        })
        
        this.buttonText = options.buttonText || 'ã‚¯ãƒªãƒƒã‚¯'
        this.buttonAction = options.buttonAction || 'button.clicked'
    }
    
    render() {
        const element = document.createElement('div')
        element.className = 'simple-button-component'
        element.style.cssText = `
            position: fixed;
            left: ${this.options.position.x}px;
            top: ${this.options.position.y}px;
            width: ${this.options.size.width}px;
            height: ${this.options.size.height}px;
            background: white;
            border: 2px solid #007acc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-family: Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            color: #007acc;
            user-select: none;
            transition: all 0.2s;
        `
        
        element.innerHTML = `
            <span class="button-text">${this.buttonText}</span>
        `
        
        this.setupEventHandlers(element)
        return element
    }
    
    setupEventHandlers(element) {
        this.addEventListener(element, 'click', () => {
            this.handleButtonClick()
        })
        
        this.addEventListener(element, 'mousedown', () => {
            element.style.transform = 'scale(0.95)'
        })
        
        this.addEventListener(element, 'mouseup', () => {
            element.style.transform = 'scale(1)'
        })
        
        this.addEventListener(element, 'mouseleave', () => {
            element.style.transform = 'scale(1)'
        })
    }
    
    handleButtonClick() {
        // Intenté€ä¿¡
        this.sendIntent(this.buttonAction, {
            buttonText: this.buttonText,
            clickTime: Date.now()
        })
        
        // ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
        this.element.style.background = '#007acc'
        this.element.style.color = 'white'
        
        setTimeout(() => {
            this.element.style.background = 'white'
            this.element.style.color = '#007acc'
        }, 150)
        
        this.log('Button clicked', { buttonText: this.buttonText })
    }
    
    updateButtonText(newText) {
        this.buttonText = newText
        const textElement = this.element.querySelector('.button-text')
        if (textElement) {
            textElement.textContent = newText
        }
    }
}
```

#### **ğŸ”§ Task 4.2: MessageLogPanelå®Ÿè£…** (3æ—¥)
**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `/charmflow/js/ui-components/MessageLogPanel.js`

**å®Ÿè£…å†…å®¹**: DEBUG_LOG Intentå—ä¿¡ãƒ»è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ 

#### **æˆåŠŸæŒ‡æ¨™**:
- [ ] SimpleButtonComponentæ­£å¸¸å‹•ä½œ
- [ ] Intenté€ä¿¡ç¢ºèª
- [ ] MessageLogPanelè¡¨ç¤ºãƒ»ãƒ­ã‚°è“„ç©
- [ ] 2ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹å‹•ä½œ

---

### **ğŸ“… Week 3: ãƒ­ã‚¸ãƒƒã‚¯ãƒãƒ¼ãƒ‰å®Ÿè£…**

#### **ğŸ”§ Task 5.1: LogicNodeComponentåŸºç›¤** (2æ—¥)
#### **ğŸ”§ Task 5.2: ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒãƒ»é¸æŠè‚¢UI** (2æ—¥)
#### **ğŸ”§ Task 5.3: è¨­å®šå¤‰æ›´Intentçµ±åˆ** (1æ—¥)

---

## ğŸ—ï¸ **Phase 3: é«˜åº¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (2-3é€±é–“)

### **ğŸ“… Week 4-5: Monaco Editorçµ±åˆ**
#### **ğŸ”§ Task 6.1: MonacoEditorComponentè¨­è¨ˆ**
#### **ğŸ”§ Task 6.2: iframe ã‚«ãƒ—ã‚»ãƒ«åŒ–å®Ÿè£…**
#### **ğŸ”§ Task 6.3: ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›´Intenté€šä¿¡**

### **ğŸ“… Week 5-6: Canvasçµ±åˆ**
#### **ğŸ”§ Task 7.1: CanvasComponentåŸºç›¤**
#### **ğŸ”§ Task 7.2: OffscreenCanvas + Web Worker**
#### **ğŸ”§ Task 7.3: æç”»å‘½ä»¤Intent ã‚·ã‚¹ãƒ†ãƒ **

---

## ğŸ—ï¸ **Phase 4: ç¶™ç¶šæ”¹å–„** (ç¶™ç¶š)

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
- UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»®æƒ³åŒ–
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡æ”¹å–„
- æç”»æœ€é©åŒ–

### **é«˜åº¦ç®¡ç†ç³»å®Ÿè£…**
- IntentRouterPanel
- PluginDebugger
- é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ç¾¤

---

## ğŸ“Š **é€²æ—ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **

### **æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**
```markdown
## Day X ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ (æ—¥ä»˜: YYYY-MM-DD)

### å®Œäº†ã‚¿ã‚¹ã‚¯
- [ ] Task X.X: å†…å®¹
- [ ] Task X.X: å†…å®¹

### ç™ºè¦‹ã—ãŸå•é¡Œ
- å•é¡Œ1: å†…å®¹ãƒ»å¯¾ç­–
- å•é¡Œ2: å†…å®¹ãƒ»å¯¾ç­–

### æ˜æ—¥ã®äºˆå®š
- Task X.X: å†…å®¹
- Task X.X: å†…å®¹

### å…¨ä½“é€²æ—
- Phase X: XX% å®Œäº†
- äºˆå®šé€šã‚Š/é…å»¶Xæ—¥
```

### **é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼**
- Phaseå®Œäº†åº¦è©•ä¾¡
- æŠ€è¡“çš„å•é¡Œã®æ•´ç†
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´
- æ¬¡é€±è¨ˆç”»èª¿æ•´

---

## ğŸš¨ **ç·Šæ€¥æ™‚å¯¾å¿œ**

### **Claude Codeè½ã¡å¯¾ç­–**
1. **é€²æ—è¨˜éŒ²**: æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¨˜å…¥
2. **ä½œæ¥­ä¸­æ–­ç‚¹**: ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
3. **å†é–‹æ‰‹é †**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªâ†’ç¾åœ¨Phaseç‰¹å®šâ†’æ¬¡ã‚¿ã‚¹ã‚¯å®Ÿè¡Œ

### **æŠ€è¡“çš„å•é¡Œå¯¾ç­–**
1. **å®Ÿè£…å›°é›£**: ã‚ˆã‚Šç°¡å˜ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«å¤‰æ›´
2. **Intenté€šä¿¡å•é¡Œ**: ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°æ´»ç”¨ãƒ»Geminiç›¸è«‡
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ**: Phase 4ã«å»¶æœŸ

### **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…å»¶å¯¾ç­–**
1. **è»½åº¦é…å»¶**: å„ªå…ˆåº¦ä½ã‚¿ã‚¹ã‚¯ã‚’Phase 4ã«ç§»å‹•
2. **é‡åº¦é…å»¶**: Phaseåˆ†å‰²ãƒ»æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹
3. **å®Œå…¨åœæ­¢**: æœ€å°å‹•ä½œç‰ˆå®Œæˆã‚’å„ªå…ˆ

---

## ğŸ¯ **æœ€çµ‚æˆåŠŸæŒ‡æ¨™**

### **Phase 1å®Œäº†æ™‚**:
- [ ] BaseUIComponentå‹•ä½œç¢ºèª
- [ ] PropertyInspectorå®Ÿç”¨ãƒ¬ãƒ™ãƒ«
- [ ] Intenté€šä¿¡åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºç«‹
- [ ] ä»–é–‹ç™ºè€…ãŒç°¡å˜ã«æ–°UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆå¯èƒ½

### **Phase 2å®Œäº†æ™‚**:
- [ ] 3ç¨®é¡ã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå‹•ä½œ
- [ ] ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã§ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºèª
- [ ] ã‚·ãƒ³ãƒ—ãƒ«â†’è¤‡é›‘ã®å®Ÿè£…çµŒé¨“è“„ç©

### **Phase 3å®Œäº†æ™‚**:
- [ ] Monaco Editorçµ±åˆå®Œäº†
- [ ] Canvasæç”»ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œ
- [ ] ã‚²ãƒ¼ãƒ é–‹ç™ºåŸºç›¤å®Œæˆ

### **Phase 4å®Œäº†æ™‚**:
- [ ] å®Ÿç”¨çš„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é”æˆ
- [ ] é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ç¾¤å®Œæˆ
- [ ] ã€Œãƒ—ãƒ©ã‚°ã‚¤ãƒ³=UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€é©å‘½é”æˆ

---

**ä½œæˆè€…**: Claude Code  
**æ‰¿èªè€…**: è¨­è¨ˆè€…ã•ã¾  
**å®Ÿè¡Œè²¬ä»»è€…**: é–‹ç™ºãƒãƒ¼ãƒ   
**æœ€çµ‚æ›´æ–°**: 2025-07-11  
**çŠ¶æ³**: å®Ÿè£…æº–å‚™å®Œäº†ãƒ»è©³ç´°è¨ˆç”»ç¢ºå®š