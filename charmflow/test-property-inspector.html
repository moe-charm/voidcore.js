<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PropertyInspectorComponent çµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #005a9e;
        }
        .test-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .mock-node {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .mock-node:hover {
            background: #bbdefb;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);
        }
        .mock-node.selected {
            background: #1976d2;
            color: white;
        }
        .results {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        .success { color: #27ae60; }
        .error { color: #e74c3c; }
        .info { color: #3498db; }
        .warning { color: #f39c12; }
        .intent-log {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-size: 11px;
        }
        .property-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” PropertyInspectorComponent çµ±åˆãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-container" style="background: #fff3cd; border: 2px solid #ffc107;">
        <h2>ğŸ“ ãƒ†ã‚¹ãƒˆæ‰‹é †ï¼ˆå¿…ãšã“ã®é †ç•ªã§ï¼ï¼‰</h2>
        <ol style="font-size: 16px; line-height: 1.8;">
            <li><strong>Step 1:</strong> ã€ŒInspectorä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            <li><strong>Step 2:</strong> ã€Œãƒã‚¦ãƒ³ãƒˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            <li><strong>Step 3:</strong> ã€Œè¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ <em>PropertyInspectorãŒç”»é¢å·¦ä¸Šã«è¡¨ç¤ºã•ã‚Œã¾ã™</em></li>
            <li><strong>Step 4:</strong> ä¸Šã®é’ã„ãƒ¢ãƒƒã‚¯ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ <em>PropertyInspectorã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</em></li>
            <li><strong>Step 5:</strong> PropertyInspectorå†…ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç·¨é›†ã—ã¦ã¿ã¦ãã ã•ã„</li>
            <li><strong>Step 6:</strong> å„ç¨®ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã§æ©Ÿèƒ½ç¢ºèª</li>
        </ol>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆå¯¾è±¡ãƒãƒ¼ãƒ‰</h2>
        <div id="mock-node-1" class="mock-node" data-node-type="input.text">
            ğŸ”¤ InputTextPlugin
            <div style="font-size: 11px; color: #666;">ID: input-text-001 | Type: input.text</div>
        </div>
        <div id="mock-node-2" class="mock-node" data-node-type="button.send">
            ğŸ”˜ ButtonSendPlugin  
            <div style="font-size: 11px; color: #666;">ID: button-send-002 | Type: button.send</div>
        </div>
        <div id="mock-node-3" class="mock-node" data-node-type="string.uppercase">
            ğŸ”  StringUppercasePlugin
            <div style="font-size: 11px; color: #666;">ID: string-upper-003 | Type: string.uppercase</div>
        </div>
        <div id="mock-node-4" class="mock-node" data-node-type="output.console">
            ğŸ“º OutputConsolePlugin
            <div style="font-size: 11px; color: #666;">ID: output-console-004 | Type: output.console</div>
        </div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ”§ PropertyInspectoråˆ¶å¾¡</h2>
        <button class="test-button" id="test-create">Inspectorä½œæˆ</button>
        <button class="test-button" id="test-mount">ãƒã‚¦ãƒ³ãƒˆ</button>
        <button class="test-button" id="test-show">è¡¨ç¤º</button>
        <button class="test-button" id="test-hide">éè¡¨ç¤º</button>
        <button class="test-button" id="test-destroy">ç ´æ£„</button>
        <button class="test-button" id="test-clear">é¸æŠè§£é™¤</button>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“¡ Intenté€šä¿¡ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-button" id="test-intent-flow">å®Œå…¨Intenté€šä¿¡ãƒ•ãƒ­ãƒ¼</button>
        <button class="test-button" id="test-property-update">ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
        <button class="test-button" id="test-undo-redo">Undo/Redoæ©Ÿèƒ½</button>
        <button class="test-button" id="test-validation">ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</button>
    </div>
    
    <div class="test-container">
        <h2>ğŸ¨ UIæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-button" id="test-drag">ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½</button>
        <button class="test-button" id="test-resize">ãƒªã‚µã‚¤ã‚ºæ©Ÿèƒ½</button>
        <button class="test-button" id="test-focus">ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ©Ÿèƒ½</button>
        <button class="test-button" id="test-advanced-mode">è©³ç´°ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“‹ ç¾åœ¨ã®é¸æŠçŠ¶æ…‹</h2>
        <div id="current-selection" class="property-preview">
            é¸æŠãªã—
        </div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“‹ ãƒ†ã‚¹ãƒˆçµæœ</h2>
        <div id="test-results" class="results">
            <div class="info">ğŸ“ PropertyInspectorComponentçµ±åˆãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†ã€‚</div>
            <div class="info">ğŸ‘† ä¸Šè¨˜ã®ãƒ¢ãƒƒã‚¯ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠâ†’Inspectorã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¡¨ç¤ºã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</div>
        </div>
    </div>

    <script type="module">
        import { PropertyInspectorComponent } from './js/ui-components/PropertyInspectorComponent.js'
        import { INTENT_TYPES } from './js/intent-definitions.js'
        
        // ==========================================
        // ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        // ==========================================
        
        let propertyInspector = null
        let selectedNode = null
        const results = document.getElementById('test-results')
        const selectionDisplay = document.getElementById('current-selection')
        
        // Intenté€šä¿¡ãƒ­ã‚°
        const intentLogs = []
        
        function logResult(message, type = 'info', data = null) {
            const timestamp = new Date().toLocaleTimeString()
            const resultDiv = document.createElement('div')
            resultDiv.className = type
            resultDiv.innerHTML = `[${timestamp}] ${message}`
            
            if (data) {
                const dataDiv = document.createElement('div')
                dataDiv.style.marginLeft = '20px'
                dataDiv.style.color = '#666'
                dataDiv.innerHTML = JSON.stringify(data, null, 2)
                resultDiv.appendChild(dataDiv)
            }
            
            results.appendChild(resultDiv)
            results.scrollTop = results.scrollHeight
        }
        
        function logIntent(direction, type, data) {
            const timestamp = new Date().toLocaleTimeString()
            const intentDiv = document.createElement('div')
            intentDiv.className = 'intent-log'
            intentDiv.innerHTML = `
                <strong>[${timestamp}] ${direction === 'send' ? 'ğŸ“¤' : 'ğŸ“¥'} Intent: ${type}</strong><br>
                ${JSON.stringify(data, null, 2)}
            `
            results.appendChild(intentDiv)
            results.scrollTop = results.scrollHeight
            
            // Intentå±¥æ­´ä¿å­˜
            intentLogs.push({ timestamp, direction, type, data })
        }
        
        // ==========================================
        // ãƒ¢ãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
        // ==========================================
        
        // ãƒ¢ãƒƒã‚¯ãƒãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿å®šç¾©
        const mockNodeData = {
            'input-text-001': {
                id: 'input-text-001',
                type: 'input.text',
                name: 'InputTextPlugin',
                properties: {
                    placeholder: { type: 'string', value: 'ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', label: 'ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼' },
                    maxLength: { type: 'number', value: 100, label: 'æœ€å¤§æ–‡å­—æ•°', min: 1, max: 1000 },
                    required: { type: 'boolean', value: false, label: 'å¿…é ˆå…¥åŠ›' },
                    multiline: { type: 'boolean', value: false, label: 'è¤‡æ•°è¡Œ' },
                    defaultValue: { type: 'string', value: '', label: 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤' },
                    validation: { type: 'string', value: 'none', label: 'ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³', options: ['none', 'email', 'url', 'number'] }
                },
                position: { x: 100, y: 200 },
                size: { width: 120, height: 60 }
            },
            'button-send-002': {
                id: 'button-send-002',
                type: 'button.send',
                name: 'ButtonSendPlugin',
                properties: {
                    label: { type: 'string', value: 'Send', label: 'ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ' },
                    color: { type: 'color', value: '#007acc', label: 'ãƒœã‚¿ãƒ³ã‚«ãƒ©ãƒ¼' },
                    size: { type: 'string', value: 'medium', label: 'ã‚µã‚¤ã‚º', options: ['small', 'medium', 'large'] },
                    disabled: { type: 'boolean', value: false, label: 'ç„¡åŠ¹çŠ¶æ…‹' },
                    icon: { type: 'string', value: 'send', label: 'ã‚¢ã‚¤ã‚³ãƒ³' },
                    confirmMessage: { type: 'string', value: '', label: 'ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸' }
                },
                position: { x: 300, y: 200 },
                size: { width: 100, height: 40 }
            },
            'string-upper-003': {
                id: 'string-upper-003', 
                type: 'string.uppercase',
                name: 'StringUppercasePlugin',
                properties: {
                    preserveSpaces: { type: 'boolean', value: true, label: 'ã‚¹ãƒšãƒ¼ã‚¹ä¿æŒ' },
                    locale: { type: 'string', value: 'ja-JP', label: 'ãƒ­ã‚±ãƒ¼ãƒ«' },
                    trimWhitespace: { type: 'boolean', value: false, label: 'ç©ºç™½å‰Šé™¤' }
                },
                position: { x: 200, y: 300 },
                size: { width: 140, height: 50 }
            },
            'output-console-004': {
                id: 'output-console-004',
                type: 'output.console',
                name: 'OutputConsolePlugin',
                properties: {
                    timestamp: { type: 'boolean', value: true, label: 'ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è¡¨ç¤º' },
                    logLevel: { type: 'string', value: 'info', label: 'ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«', options: ['debug', 'info', 'warn', 'error'] },
                    maxLines: { type: 'number', value: 100, label: 'æœ€å¤§è¡Œæ•°', min: 10, max: 1000 },
                    fontSize: { type: 'number', value: 12, label: 'ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º', min: 8, max: 24 },
                    backgroundColor: { type: 'color', value: '#1e1e1e', label: 'èƒŒæ™¯è‰²' },
                    textColor: { type: 'color', value: '#ffffff', label: 'æ–‡å­—è‰²' }
                },
                position: { x: 400, y: 100 },
                size: { width: 200, height: 150 }
            }
        }
        
        // ãƒ¢ãƒƒã‚¯IntentHandler
        const mockIntentHandler = {
            intentHandlers: new Map(),
            
            sendIntent: function(type, data) {
                logIntent('send', type, data)
                
                // PropertyInspectoré–¢é€£Intentã‚’è‡ªå‹•å‡¦ç†
                if (type === INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY) {
                    // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°ã‚’å…ƒãƒãƒ¼ãƒ‰ã«åæ˜ ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
                    if (selectedNode && mockNodeData[selectedNode.id]) {
                        const nodeData = mockNodeData[selectedNode.id]
                        if (nodeData.properties[data.propertyName]) {
                            nodeData.properties[data.propertyName].value = data.newValue
                            updateSelectionDisplay()
                            logResult('âœ… ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°ãŒå…ƒãƒãƒ¼ãƒ‰ã«åæ˜ ã•ã‚Œã¾ã—ãŸ', 'success', {
                                nodeId: selectedNode.id,
                                property: data.propertyName,
                                newValue: data.newValue
                            })
                        }
                    }
                }
            },
            
            addIntentListener: function(type, handler) {
                this.intentHandlers.set(type, handler)
                const listenerId = `listener-${type}-${Date.now()}`
                logResult(`ğŸ‘‚ Intent listenerè¿½åŠ : ${type}`, 'info', { listenerId })
                return listenerId
            },
            
            removeIntentListener: function(listenerId) {
                logResult(`ğŸ—‘ï¸ Intent listenerå‰Šé™¤: ${listenerId}`, 'info')
            },
            
            // Intentæ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
            triggerIntent: function(type, data) {
                logIntent('receive', type, data)
                const handler = this.intentHandlers.get(type)
                if (handler) {
                    handler(data)
                } else {
                    logResult(`âš ï¸ Intent handler not found: ${type}`, 'warning')
                }
            }
        }
        
        // ãƒ¢ãƒƒã‚¯PluginNode
        const mockPluginNode = {
            id: 'property-inspector-test-node',
            intentHandler: mockIntentHandler
        }
        
        // é¸æŠçŠ¶æ…‹è¡¨ç¤ºæ›´æ–°
        function updateSelectionDisplay() {
            if (selectedNode) {
                const nodeData = mockNodeData[selectedNode.id]
                selectionDisplay.innerHTML = `
                    <strong>${nodeData.name}</strong> (${nodeData.id})<br>
                    <strong>Properties:</strong><br>
                    ${Object.entries(nodeData.properties).map(([key, prop]) => 
                        `â€¢ ${prop.label}: ${JSON.stringify(prop.value)} (${prop.type})`
                    ).join('<br>')}
                `
            } else {
                selectionDisplay.innerHTML = 'é¸æŠãªã—'
            }
        }
        
        // ==========================================
        // ãƒ¢ãƒƒã‚¯ãƒãƒ¼ãƒ‰é¸æŠæ©Ÿèƒ½
        // ==========================================
        
        // ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯å‡¦ç†
        document.querySelectorAll('.mock-node').forEach(node => {
            node.addEventListener('click', () => {
                // å‰ã®é¸æŠè§£é™¤
                document.querySelectorAll('.mock-node').forEach(n => n.classList.remove('selected'))
                
                // æ–°ã—ã„é¸æŠ
                node.classList.add('selected')
                // IDãƒãƒƒãƒ”ãƒ³ã‚°ä¿®æ­£
                const nodeId = node.id.replace('mock-node-1', 'input-text-001')
                    .replace('mock-node-2', 'button-send-002')
                    .replace('mock-node-3', 'string-upper-003')
                    .replace('mock-node-4', 'output-console-004')
                selectedNode = { id: nodeId }
                
                // é¸æŠè¡¨ç¤ºæ›´æ–°
                updateSelectionDisplay()
                
                // PropertyInspectorã«NODE_SELECTED Intenté€ä¿¡
                if (propertyInspector) {
                    const nodeData = mockNodeData[nodeId]
                    mockIntentHandler.triggerIntent(
                        INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_SELECTED,
                        {
                            nodeId: nodeData.id,
                            nodeType: nodeData.type,
                            properties: nodeData.properties,
                            position: nodeData.position,
                            metadata: {
                                name: nodeData.name,
                                size: nodeData.size
                            }
                        }
                    )
                } else {
                    logResult('âš ï¸ PropertyInspectorãŒã¾ã ä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning')
                }
            })
        })
        
        // ==========================================
        // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
        // ==========================================
        
        // PropertyInspectoråˆ¶å¾¡
        document.getElementById('test-create').onclick = () => {
            try {
                propertyInspector = new PropertyInspectorComponent(mockPluginNode, {
                    position: { x: 50, y: 50 },
                    size: { width: 350, height: 500 },
                    autoSave: true,
                    showAdvanced: false,
                    enableUndo: true
                })
                
                logResult('âœ… PropertyInspectorComponentä½œæˆæˆåŠŸ', 'success', {
                    id: propertyInspector.id,
                    type: propertyInspector.type
                })
            } catch (error) {
                logResult('âŒ PropertyInspectorComponentä½œæˆå¤±æ•—', 'error', { error: error.message })
            }
        }
        
        document.getElementById('test-mount').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            try {
                const mountedElement = propertyInspector.mount()
                logResult('âœ… ãƒã‚¦ãƒ³ãƒˆæˆåŠŸ', 'success', {
                    elementId: mountedElement.id,
                    isMounted: propertyInspector.state.isMounted
                })
            } catch (error) {
                logResult('âŒ ãƒã‚¦ãƒ³ãƒˆå¤±æ•—', 'error', { error: error.message })
            }
        }
        
        document.getElementById('test-show').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            propertyInspector.show()
            logResult('ğŸ‘ï¸ PropertyInspectorè¡¨ç¤ºå®Ÿè¡Œ', 'success', { isVisible: propertyInspector.state.isVisible })
        }
        
        document.getElementById('test-hide').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            propertyInspector.hide()
            logResult('ğŸ™ˆ PropertyInspectoréè¡¨ç¤ºå®Ÿè¡Œ', 'success', { isVisible: propertyInspector.state.isVisible })
        }
        
        document.getElementById('test-destroy').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            propertyInspector.destroy()
            logResult('ğŸ’¥ PropertyInspectorç ´æ£„å®Ÿè¡Œ', 'success', { isDestroyed: propertyInspector.isDestroyed })
            propertyInspector = null
        }
        
        document.getElementById('test-clear').onclick = () => {
            // é¸æŠè§£é™¤
            document.querySelectorAll('.mock-node').forEach(n => n.classList.remove('selected'))
            selectedNode = null
            updateSelectionDisplay()
            
            // PropertyInspectorã«NODE_DESELECTED Intenté€ä¿¡
            if (propertyInspector) {
                mockIntentHandler.triggerIntent(
                    INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_DESELECTED,
                    { reason: 'manual-clear' }
                )
            }
            
            logResult('ğŸ”„ é¸æŠè§£é™¤ãƒ»Inspector ã‚¯ãƒªã‚¢', 'success')
        }
        
        // Intenté€šä¿¡ãƒ†ã‚¹ãƒˆ
        document.getElementById('test-intent-flow').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆãƒ»è¡¨ç¤ºã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            logResult('ğŸš€ å®Œå…¨Intenté€šä¿¡ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info')
            
            // 1. ãƒãƒ¼ãƒ‰é¸æŠã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            setTimeout(() => {
                const testNodeData = mockNodeData['button-send-002']
                mockIntentHandler.triggerIntent(
                    INTENT_TYPES.UI.PROPERTY_INSPECTOR.NODE_SELECTED,
                    {
                        nodeId: testNodeData.id,
                        nodeType: testNodeData.type,
                        properties: testNodeData.properties,
                        position: testNodeData.position,
                        metadata: { name: testNodeData.name, size: testNodeData.size }
                    }
                )
                logResult('ğŸ“‹ Phase 1: ãƒãƒ¼ãƒ‰é¸æŠIntenté€ä¿¡å®Œäº†', 'success')
            }, 500)
            
            // 2. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            setTimeout(() => {
                // PropertyInspectorã®å†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥å‘¼ã³å‡ºã—ã¦ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                if (propertyInspector.currentNodeData) {
                    logResult('ğŸ“‹ Phase 2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ›´ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆå®Ÿè¡Œ', 'info')
                    
                    // UPDATE_NODE_PROPERTY Intenté€ä¿¡ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    mockIntentHandler.sendIntent(
                        INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY,
                        {
                            nodeId: 'button-send-002',
                            propertyName: 'label',
                            newValue: 'Updated Send Button',
                            oldValue: 'Send',
                            propertyType: 'string'
                        }
                    )
                    
                    logResult('ğŸ“‹ Phase 2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°Intenté€ä¿¡å®Œäº†', 'success')
                } else {
                    logResult('âš ï¸ Phase 2: ãƒãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning')
                }
            }, 1500)
            
            setTimeout(() => {
                logResult('ğŸ‰ å®Œå…¨Intenté€šä¿¡ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†', 'success')
            }, 2000)
        }
        
        document.getElementById('test-property-update').onclick = () => {
            if (!propertyInspector || !selectedNode) {
                logResult('âš ï¸ PropertyInspectorã‚’ä½œæˆã—ã€ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            const nodeData = mockNodeData[selectedNode.id]
            const properties = Object.keys(nodeData.properties)
            const randomProperty = properties[Math.floor(Math.random() * properties.length)]
            const prop = nodeData.properties[randomProperty]
            
            let newValue
            switch (prop.type) {
                case 'string':
                    newValue = `Updated_${Date.now()}`
                    break
                case 'number':
                    newValue = Math.floor(Math.random() * 100) + 1
                    break
                case 'boolean':
                    newValue = !prop.value
                    break
                case 'color':
                    newValue = `#${Math.floor(Math.random()*16777215).toString(16)}`
                    break
                default:
                    newValue = 'test_value'
            }
            
            mockIntentHandler.sendIntent(
                INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY,
                {
                    nodeId: selectedNode.id,
                    propertyName: randomProperty,
                    newValue: newValue,
                    oldValue: prop.value,
                    propertyType: prop.type
                }
            )
            
            logResult('ğŸ”„ ãƒ©ãƒ³ãƒ€ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ', 'success', {
                property: randomProperty,
                oldValue: prop.value,
                newValue: newValue
            })
        }
        
        document.getElementById('test-undo-redo').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            logResult('â†©ï¸ Undo/Redoæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆï¼ˆPropertyInspectorå†…éƒ¨æ©Ÿèƒ½ï¼‰', 'info')
            logResult('ğŸ’¡ å®Ÿéš›ã®Undo/Redoã¯ã€PropertyInspectorå†…ã®ãƒœã‚¿ãƒ³ã§æ“ä½œã§ãã¾ã™', 'info')
        }
        
        document.getElementById('test-validation').onclick = () => {
            if (!propertyInspector || !selectedNode) {
                logResult('âš ï¸ PropertyInspectorã‚’ä½œæˆã—ã€ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            // ç„¡åŠ¹ãªå€¤ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
            mockIntentHandler.sendIntent(
                INTENT_TYPES.UI.PROPERTY_INSPECTOR.UPDATE_NODE_PROPERTY,
                {
                    nodeId: selectedNode.id,
                    propertyName: 'maxLength',
                    newValue: -10, // ç„¡åŠ¹ãªå€¤
                    oldValue: 100,
                    propertyType: 'number'
                }
            )
            
            logResult('âš ï¸ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ: ç„¡åŠ¹å€¤ï¼ˆ-10ï¼‰ã§maxLengthæ›´æ–°è©¦è¡Œ', 'warning')
        }
        
        // UIæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
        document.getElementById('test-drag').onclick = () => {
            if (!propertyInspector || !propertyInspector.element) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆãƒ»ãƒã‚¦ãƒ³ãƒˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            logResult('ğŸ–±ï¸ ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½ã¯æ—¢ã«æœ‰åŠ¹ã§ã™ã€‚ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ã¿ã¦ãã ã•ã„', 'info')
        }
        
        document.getElementById('test-resize').onclick = () => {
            if (!propertyInspector || !propertyInspector.element) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆãƒ»ãƒã‚¦ãƒ³ãƒˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            logResult('ğŸ“ ãƒªã‚µã‚¤ã‚ºæ©Ÿèƒ½ã¯æ—¢ã«æœ‰åŠ¹ã§ã™ã€‚å³ä¸‹è§’ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ã¿ã¦ãã ã•ã„', 'info')
        }
        
        document.getElementById('test-focus').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            propertyInspector.focus()
            logResult('ğŸ¯ PropertyInspectorãƒ•ã‚©ãƒ¼ã‚«ã‚¹å®Ÿè¡Œ', 'success')
        }
        
        document.getElementById('test-advanced-mode').onclick = () => {
            if (!propertyInspector) {
                logResult('âš ï¸ å…ˆã«PropertyInspectorã‚’ä½œæˆã—ã¦ãã ã•ã„', 'error')
                return
            }
            
            // è©³ç´°ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ï¼ˆPropertyInspectorå†…éƒ¨æ©Ÿèƒ½ï¼‰
            logResult('âš™ï¸ è©³ç´°ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ï¼ˆPropertyInspectorå†…éƒ¨ã®è¨­å®šãƒœã‚¿ãƒ³ã§æ“ä½œå¯èƒ½ï¼‰', 'info')
        }
        
        // ==========================================
        // åˆæœŸåŒ–
        // ==========================================
        
        logResult('ğŸš€ PropertyInspectorComponentçµ±åˆãƒ†ã‚¹ãƒˆç’°å¢ƒåˆæœŸåŒ–å®Œäº†', 'success')
        logResult('ğŸ“ ãƒ†ã‚¹ãƒˆæ‰‹é †:', 'info')
        logResult('  1. "Inspectorä½œæˆ" â†’ "ãƒã‚¦ãƒ³ãƒˆ" â†’ "è¡¨ç¤º"', 'info')
        logResult('  2. ä¸Šè¨˜ã®ãƒ¢ãƒƒã‚¯ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¡¨ç¤ºç¢ºèª', 'info')
        logResult('  3. Intenté€šä¿¡ãƒ†ã‚¹ãƒˆãƒ»UIæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ', 'info')
        logResult('  4. PropertyInspectorå†…ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å¤‰æ›´ã—ã¦æ›´æ–°Intentç¢ºèª', 'info')
        
    </script>
</body>
</html>